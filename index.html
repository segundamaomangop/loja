      const preco = byId("filtroPreco").value;

      let filtrados = produtos.filter(p =>
        (!cat   || p.category === cat) &&
        (!est   || p.estado === est) &&
        (!marca || normalize(p.marca).includes(marca))
      );

      if (preco === "asc") filtrados.sort((a,b)=>a.price-b.price);
      if (preco === "desc") filtrados.sort((a,b)=>b.price-a.price);

      renderProducts(filtrados);
    }

    // Pesquisa com debounce
    const pesquisarDebounced = debounce(() => {
      const termo = normalize(byId("search").value);
      const filtrados = produtos.filter(p => normalize(p.name).includes(termo));
      renderProducts(filtrados);
    }, 250);

    // InicializaÃ§Ã£o ao carregar a pÃ¡gina
    document.addEventListener("DOMContentLoaded", () => {
      renderProducts(produtos);
      renderCart();

      byId("checkoutBtn").addEventListener("click", () => {
        localStorage.setItem("carrinhoSegundaMaoMangop", JSON.stringify(cart));
        window.location.href = "carrinho.html";
      });

      byId("filtroCategoria").addEventListener("change", aplicarFiltros);
      byId("filtroEstado").addEventListener("change", aplicarFiltros);
      byId("filtroMarca").addEventListener("input", debounce(aplicarFiltros, 250));
      byId("filtroPreco").addEventListener("change", aplicarFiltros);

      byId("search").addEventListener("input", pesquisarDebounced);
      byId("clearSearch").addEventListener("click", () => {
        byId("search").value = "";
        renderProducts(produtos);
      });

      // Toggle do carrinho flutuante (mobile)
      const carrinho = document.querySelector(".sidebar.carrinho");
      const filtros = document.querySelector(".sidebar.filtros");
      const toggleBtn = document.querySelector(".cart-toggle");

      if (toggleBtn && carrinho) {
        toggleBtn.addEventListener("click", () => {
          carrinho.classList.toggle("aberto");
          if (window.innerWidth <= 600 && filtros) {
            filtros.style.display = carrinho.classList.contains("aberto") ? "none" : "block";
          }
        });
      }
    });
  </script>

  <!-- BotÃ£o flutuante do carrinho -->
  <button class="cart-toggle">ðŸ›’ Carrinho</button>
</body>
</html>
